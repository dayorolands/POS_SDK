image: androidsdk/android-30

pipelines:
  default:
    - parallel:
      - step:
          name: Cluster Staging Application
          deployment: staging
          caches:
            - gradle
          script:
            - echo "$SIGNING_JKS_FILE" | base64 -d > android-signing-keystore.jks
            - ./gradlew assembleHeritageReleaseStaging
          artifacts:
            - app/build/outputs/**
            - app/build/reports/**
      - step:
          name: Cluster Prod Application
          deployment: production
          caches:
            - gradle
          script:
            - echo "$SIGNING_JKS_FILE" | base64 -d > android-signing-keystore.jks
            - ./gradlew assembleRelease
          artifacts:
            - app/build/outputs/**
            - app/build/reports/**
